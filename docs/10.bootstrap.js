(self.webpackChunkcreate_wasm_app=self.webpackChunkcreate_wasm_app||[]).push([[10],{10:(e,t,n)=>{"use strict";n.a(e,(async e=>{n.r(t),n(411),n(162);var i=n(640),r=n(406),a=n(690),o=n(36),d=n(340),u=e([a,r]);[a,r]=u.then?await u:u,"/"===window.location.pathname?(0,d.L)():"/home"===window.location.pathname?(0,i.L)():"/playground"===window.location.pathname?(0,d.L)():"/gallery"===window.location.pathname?(0,r.l)():"/webgpu"===window.location.pathname?(0,a.M)():"/localhost_3d"===window.location.pathname?(0,o.z)():console.error("404")}))},32:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});const i={default:0,WATER:1,FIRE:2,ELECTRIC:3,METAL:4,TURBO:5,COCKPIT:6,WOOD:7,LEAF:8,ROCK:9,CORE:10,RADAR:11}},406:(e,t,n)=>{"use strict";n.a(e,(async e=>{n.d(t,{l:()=>c});var i=n(650),r=(n(411),n(162),n(361)),a=n(437),o=n(209),d=n(291),u=e([r,i]);[r,i]=u.then?await u:u;const s=13;function c(){let e=!1;const t=window.location.search.replace("?","").split("&");for(var n of t){const t=n.split("=")[0],i=n.split("=")[1];"webgpu"===t&&"true"===i&&(e=!0)}document.getElementById("content").innerHTML='<canvas id="canvas"></canvas>\n<div id="panel">\n<div id="menu">\n  <a href="/playground">Playground</a>\n  <a href="/gallery">Gallery</a>\n  <a href="/gallery?webgpu=true">Gallery (WebGPU)</a>\n</div>\n  <canvas id="minimap"></canvas>\n  <div>\n    Zoom: <input type="range" min="0" max="1000" value="0" id="zoom_slider">\n  </div>\n  <div>\n    x: <input type="range" min="0" max="1000" value="500" id="x_slider">\n  </div>\n  <div>\n    y: <input type="range" min="0" max="1000" value="500" id="y_slider">\n  </div>\n  <p id="p_step"></p>\n  <p id="p_fps"></p>\n  <p id="p_render_duration"></p>\n  <p id="p_cps"></p>\n  <p id="p_compute_duration"></p>\n  <p id="p_pids"></p>\n  <pre id="p_counter_global"></pre>\n  <pre id="p_counter_activity"></pre>\n  <pre id="p_counter_collision"></pre>\n  <pre id="p_counter_linked"></pre>\n  <p id="p_energy"></p>\n</div>';const r=i.xF.new(128,128),d=i.fU.new(5,.25,5);d.add(0,1,6),d.add(1,0,7);d.add(1,3,3),d.add(3,0,3),d.add(1,4,5),d.add(5,0,5),d.add(1,6,6),d.add(7,0,6),d.add(6,4,5),d.add(5,7,5),r.add_entity(d,i.E9.new(0,0));for(var u=0;u<10;u++)r.add_entity(d,i.E9.new(Math.random(),Math.random()));if(m(r),!0===e)if("gpu"in navigator)!async function(e){const t=await navigator.gpu.requestAdapter();if(!t)return void console.error("No gpu adapter found");const n={buffer_size:212992},i={data_buffer_size:n.buffer_size,image_width:Math.floor(.5*window.innerWidth),image_height:Math.floor(.5*window.innerHeight),max_parts_sqrt:64};i.device=await t.requestDevice(),i.buffers={write:i.device.createBuffer({size:n.buffer_size,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),in:i.device.createBuffer({size:n.buffer_size,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}),out:i.device.createBuffer({size:_(i),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}),previous_img:i.device.createBuffer({size:_(i),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}),read:i.device.createBuffer({size:_(i),usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),write_data:i.device.createBuffer({size:48,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),in_data:i.device.createBuffer({size:48,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC})},i.bind_group_layouts={reset:i.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),trace:i.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]})},i.bind_groups={reset:i.device.createBindGroup({layout:i.bind_group_layouts.reset,entries:[{binding:0,resource:{buffer:i.buffers.previous_img}},{binding:1,resource:{buffer:i.buffers.out}}]}),trace:i.device.createBindGroup({layout:i.bind_group_layouts.trace,entries:[{binding:0,resource:{buffer:i.buffers.in}},{binding:1,resource:{buffer:i.buffers.out}},{binding:2,resource:{buffer:i.buffers.in_data}}]})},i.workgroup_size=16,i.dispatch=Math.ceil(64/i.workgroup_size),i.compute_pipelines={reset:i.device.createComputePipeline({layout:i.device.createPipelineLayout({bindGroupLayouts:[i.bind_group_layouts.reset]}),compute:{module:i.device.createShaderModule({code:a.U(i)}),entryPoint:"main"}}),trace:i.device.createComputePipeline({layout:i.device.createPipelineLayout({bindGroupLayouts:[i.bind_group_layouts.trace]}),compute:{module:i.device.createShaderModule({code:o.U(i)}),entryPoint:"main"}})};const r=document.getElementById("canvas");r.width=i.image_width,r.height=i.image_height,r.style.width=window.innerWidth+"px",r.style.height=window.innerHeight+"px";p(e,i,r.getContext("2d"))}(r);else{const e="Gravitle works best with WebGPU.\nInstructions on how to enable at https://web.dev/gpu/#use";alert(e),console.error(e),g(r)}else g(r)}async function p(e,t,n){const i=performance.now();void 0===t.fps_counter&&(t.fps_counter=[]),void 0===t.fps_counter_length&&(t.fps_counter_length=100);const a=Math.max(canvas.width,canvas.height),o={x:document.getElementById("x_slider").value/1e3,y:document.getElementById("y_slider").value/1e3,zoom:1e3/(1e3-document.getElementById("zoom_slider").value)},u=f(o,a),c=(u.canvas,new Float32Array(new Float32Array(r.memory.buffer,e.parts_ptr(),s*e.parts_count()))),g=(canvas.width,canvas.height,o.x-.5/o.zoom*t.image_width/a),m=o.y-.5/o.zoom*t.image_height/a,h=g+1/o.zoom*t.image_width/a,w=m+1/o.zoom*t.image_height/a;for(let t=0;t<e.parts_count();t++){const e=c[t*s+0],n=c[t*s+1];l(e,n,c[t*s+4],u,!(g<=e&&e<=h&&m<=n&&n<=w))}let y=t.buffers.write.mapAsync(GPUMapMode.WRITE),b=t.buffers.write_data.mapAsync(GPUMapMode.WRITE);await y,await b,new Float32Array(t.buffers.write.getMappedRange()).set(c);const v=e.parts_count();new Float32Array(t.buffers.write_data.getMappedRange()).set([o.zoom,o.x,o.y,v,t.image_width,t.image_height,g,m,h,w,performance.now(),e.get_step()/1]),t.buffers.write.unmap(),t.buffers.write_data.unmap();{const e=t.device.createCommandEncoder(),n=e.beginComputePass();n.setPipeline(t.compute_pipelines.reset),n.setBindGroup(0,t.bind_groups.reset),n.dispatch(t.image_width,t.image_height),n.endPass();const i=e.finish();t.device.queue.submit([i])}{const e=t.device.createCommandEncoder();e.copyBufferToBuffer(t.buffers.write,0,t.buffers.in,0,t.data_buffer_size),e.copyBufferToBuffer(t.buffers.write_data,0,t.buffers.in_data,0,48);const n=e.beginComputePass();n.setPipeline(t.compute_pipelines.trace),n.setBindGroup(0,t.bind_groups.trace),n.dispatch(t.dispatch,t.dispatch),n.endPass(),e.copyBufferToBuffer(t.buffers.out,0,t.buffers.read,0,_(t)),e.copyBufferToBuffer(t.buffers.out,0,t.buffers.previous_img,0,_(t));const i=e.finish();t.device.queue.submit([i])}let x=t.buffers.read.mapAsync(GPUMapMode.READ);await x,n.putImageData(new ImageData(Uint8ClampedArray.from(new Uint32Array(t.buffers.read.getMappedRange())),t.image_width,t.image_height),0,0),t.buffers.read.unmap(),document.getElementById("p_counter_global").innerHTML=`Global:      ${e.get_counter_value(0).toFixed(2)}ms`,(0,d.O)(t),window.requestAnimationFrame((function(){p(e,t,n)}));const P=performance.now();t.fps_counter.push({start:i,end:P,duration:P-i})}function _(e){return e.image_width*e.image_height*4*4}function f(e,t){const n=document.getElementById("minimap");n.width=256,n.height=256;const i=n.getContext("2d");return i.beginPath(),i.fillStyle="#ff000088",i.rect(e.x*n.width-.5*n.width/e.zoom,e.y*n.height-.5*n.height/e.zoom,n.width/e.zoom,n.height/e.zoom),i.fill(),i.beginPath(),i.fillStyle="#FFFF0088",i.rect(e.x*n.width-.5*n.width/e.zoom*canvas.width/t,e.y*n.height-.5*n.height/e.zoom*canvas.height/t,n.width/e.zoom*canvas.width/t,n.height/e.zoom*canvas.height/t),i.fill(),i.fillStyle="#000",i}function l(e,t,n,i,r){i.fillStyle=r?"#888":"#000",i.beginPath(),i.arc(e*minimap.width,t*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc((e+1)*minimap.width,t*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc((e-1)*minimap.width,t*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc(e*minimap.width,(t+1)*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc(e*minimap.width,(t-1)*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill()}function g(e){const t=document.getElementById("canvas");t.width=window.innerWidth,t.height=window.innerHeight,t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px";const n=t.getContext("2d"),i=Math.max(t.width,t.height),a={x:document.getElementById("x_slider").value/1e3,y:document.getElementById("y_slider").value/1e3,zoom:1e3/(1e3-document.getElementById("zoom_slider").value)},o=f(a,i),d=(o.canvas,new Float32Array(r.memory.buffer,e.parts_ptr(),s*e.parts_count())),u=.5*(1-1/a.zoom),c=u*t.width/i,p=u*t.height/i,_=(i-t.width)/i*.5,m=(i-t.height)/i*.5;for(let t=0;t<e.parts_count();t++){const e=d[t*s+0],r=d[t*s+1],u=d[t*s+4];l(e,r,u,o),n.fillStyle="#aaa",n.beginPath(),n.arc((e+.5-a.x-c-_)*a.zoom*i,(r+.5-a.y-p-m)*a.zoom*i,u*i*.5*a.zoom,0,2*Math.PI),n.fill()}window.requestAnimationFrame((function(){g(e)}))}function m(e){e.tick(),window.setTimeout((async function(){await m(e)}),5)}}))},640:(e,t,n)=>{"use strict";function i(){document.getElementById("content").innerHTML='<a href="/playground">Playground</a>\n<a href="/gallery">Gallery</a>\n<a href="/webgpu">webgpu</a>\n<a href="/localhost_3d">3D</a>\n'}n.d(t,{L:()=>i})},36:(e,t,n)=>{"use strict";n.d(t,{z:()=>u}),n(411),n(162);var i=n(212),r=n(980),a=n(291);function o(e){console.log("starting");const t=new i.cPb(e.fov,window.innerWidth/window.innerHeight,e.clipping.near,e.clipping.far);t.position.x=.5,t.position.y=.5,t.position.z=.5;const n=new i.CP7;n.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(n.domElement);const r=new i.xsS,a=new i.cek(16777215,.8,100);a.position.set(t.position.x,t.position.y,t.position.z),r.add(a);const o=document.getElementById("minimap");o.width=e.image_width,o.height=e.image_height;const u=o.getContext("2d");d({scene:r,renderer:n,camera:t,minimap:o,ctx_minimap:u,pull:e.pull,fps_counter:[],fps_counter_length:100,materials:{default:new i.YBo({color:15658496})},meshes:[]})}function d(e){requestAnimationFrame((function(){d(e)}));const t=performance.now();e.camera.rotation.y+=3e-4;const n=e.pull();if((0,r.Zh)(n)){const t=JSON.parse(n);void 0===e.geometry&&t.diameter&&(e.geometry=new i.cJO(.5*t.diameter,4)),t.step&&(document.getElementById("p_step").innerHTML=`Step: ${t.step} `),document.getElementById("p_pids").innerHTML=`Particles: ${t.pids.length} `,e.ctx_minimap.clearRect(0,0,e.minimap.width,e.minimap.height);let r=0;for(let n in t.parts){let a=t.parts[n];r<3e3&&(e.meshes.length==r&&(e.meshes.push(new i.Kj0(e.geometry,e.materials.default)),e.scene.add(e.meshes[r])),e.meshes[r].position.x=1*a.x,e.meshes[r].position.y=1*a.y,e.meshes[r].position.z=1*a.z,r++)}for(let t=r;t<e.meshes.length;t++)e.meshes[t].position.x=0,e.meshes[t].position.y=0,e.meshes[t].position.z=0}e.renderer.render(e.scene,e.camera),(0,a.O)(e);const o=performance.now();e.fps_counter.push({start:t,end:o,duration:o-t})}function u(){document.getElementById("content").innerHTML='  <canvas id="canvas"></canvas>\n  <div id="panel">\n    <canvas id="minimap"></canvas>\n    <p id="p_step"></p>\n    <p id="p_fps"></p>\n    <p id="p_render_duration"></p>\n    <p id="p_cps"></p>\n    <p id="p_compute_duration"></p>\n    <p id="p_pids"></p>\n  </div>\n';let e=new WebSocket("ws://127.0.0.1:8000/ws"),t={};e.onopen=function(t){console.log("[open] Connection established"),console.log("Sending to server"),e.send(JSON.stringify({request:"create_sender",uuid:(0,r.vc)()}))},e.onmessage=function(e){t=e.data},e.onclose=function(e){e.wasClean?console.error(`[close] Connection closed cleanly, code=${e.code} reason=${e.reason}`):console.error("[close] Connection died")},e.onerror=function(e){console.error(`[error] ${e.message}`)},o({pull:function(){return t},fps_counter_length:100,fps_counter:[],image_width:512,image_height:512,fov:65,clipping:{near:.01,far:5}})}},340:(e,t,n)=>{"use strict";n.d(t,{L:()=>c});var i=n(980);let r,a;const o={},d={},u={frame:{values:[],size:100,start:void 0,value:void 0},render:{values:[],size:100,start:void 0,value:void 0},render_minimap:{values:[],size:100,start:void 0,value:void 0},render_view:{values:[],size:100,start:void 0,value:void 0}},s=[{location:"Germany",url:"ws://136.243.64.165:8000/ws"},{location:"Local",url:"ws://127.0.0.1:8000/ws"}];function c(){!function(){g("frame"),g("render"),document.getElementById("content").innerHTML=`<canvas id="canvas"></canvas>\n<div id="panel">\n\x3c!-- <div id="menu">\n  <a href="/playground">Playground</a>\n  <a href="/gallery">Gallery</a>\n  <a href="/gallery?webgpu=true">Gallery (WebGPU)</a>\n</div> --\x3e\n  <canvas id="minimap"></canvas>\n  ${function(){let e="";for(var t of s)e+=`<option value="${t.url}">${t.location}</option>`;return`  <div>\n    <select name="url_selector" id="url_selector">\n      ${e}\n    </select>\n    <span id="connection_status">Connecting</span>\n  </div>`}()}\n  <div>\n    Zoom: <input type="range" min="0" max="1000" value="800" id="zoom_slider">\n  </div>\n  <div>\n    x: <input type="range" min="0" max="1000" value="100" id="x_slider">\n  </div>\n  <div>\n    y: <input type="range" min="0" max="1000" value="100" id="y_slider">\n  </div>\n  <p id="p_step"></p>\n  <p id="p_fps"></p>\n\n  <p id="p_counter_frame"></p>\n  <p id="p_counter_render"></p>\n  <p id="p_counter_render_minimap"></p>\n  <p id="p_counter_render_view"></p>\n\n  <p id="p_render_duration"></p>\n  <p id="p_counter_map"></p>\n  <p id="p_counter_await_map"></p>\n  <p id="p_counter_put_image"></p>\n  <p id="p_cps"></p>\n  <p id="p_compute_duration"></p>\n  <p id="p_pids"></p>\n  <pre id="p_counter_global"></pre>\n  <pre id="p_counter_activity"></pre>\n  <pre id="p_counter_collision"></pre>\n  <pre id="p_counter_linked"></pre>\n  <p id="p_energy"></p>\n</div>`,o.canvas=document.getElementById("minimap"),o.context=o.canvas.getContext("2d");const e=256;o.canvas.width=e,o.canvas.height=e,o.canvas.style.width=e+"px",o.canvas.style.height=e+"px",d.canvas=document.getElementById("canvas"),d.context=d.canvas.getContext("2d"),d.canvas.width=window.innerWidth,d.canvas.height=window.innerHeight,d.canvas.style.width=window.innerWidth+"px",d.canvas.style.height=window.innerHeight+"px",document.getElementById("url_selector").addEventListener("change",(function(){h()}))}(),h(),p()}function p(){m("frame"),g("frame"),g("render");const e={x:document.getElementById("x_slider").value/1e3,y:document.getElementById("y_slider").value/1e3,zoom:1e3/(1e3-document.getElementById("zoom_slider").value)};if(void 0!==r){const t=new DataView(r),n=!0,i=t.getUint32(0,n),a=(t.getUint32(4,n),t.getUint32(8,n),t.getUint32(12,n),t.getUint32(16,n),t.getUint32(20,n),t.getUint32(24,n),t.getUint32(28,n)),u=f(d),s=e.x-.5/e.zoom*d.canvas.width/u,c=e.y-.5/e.zoom*d.canvas.height/u,p=s+1/e.zoom*d.canvas.width/u,h=c+1/e.zoom*d.canvas.height/u;g("render_minimap"),_(o.canvas,o.context,"#ffff0004"),function(e,t,n){const i=f(n);t.context.beginPath(),t.context.fillStyle="#ff000088",t.context.rect(e.x*t.canvas.width-.5*t.canvas.width/e.zoom,e.y*t.canvas.height-.5*t.canvas.height/e.zoom,t.canvas.width/e.zoom,t.canvas.height/e.zoom),t.context.fill(),t.context.beginPath(),t.context.fillStyle="#FFFF0088",t.context.rect(e.x*t.canvas.width-.5*t.canvas.width/e.zoom*n.canvas.width/i,e.y*t.canvas.height-.5*t.canvas.height/e.zoom*n.canvas.height/i,t.canvas.width/e.zoom*n.canvas.width/i,t.canvas.height/e.zoom*n.canvas.height/i),t.context.fill(),t.context.fillStyle="#000"}(e,o,d);for(let e=0;e<a;e+=2){const i=40+9*e*4,r=t.getFloat32(i+0,n),a=(t.getFloat32(i+4,n),t.getFloat32(i+8,n)),d=t.getFloat32(i+12,n),u=(t.getUint32(i+24,n),s<=a&&a<=p&&c<=d&&d<=h);l(a,d,2*r,o.context,u,o.canvas)}m("render_minimap"),g("render_view"),_(d.canvas,d.context,"#00000080");const w=.5*(1-1/e.zoom),y=w*d.canvas.width/u,b=w*d.canvas.height/u,v=(u-d.canvas.width)/u*.5,x=(u-d.canvas.height)/u*.5;for(let i=0;i<a;i+=1){const r=40+9*i*4,a=t.getFloat32(r+0,n),o=(t.getFloat32(r+4,n),t.getFloat32(r+8,n)),_=t.getFloat32(r+12,n),f=t.getUint32(r+24,n),l=Math.max(0,Math.min(1,t.getFloat32(r+28,n))),g=t.getFloat32(r+32,n);if(s<=o&&o<=p&&c<=_&&_<=h){if(2==f){d.context.fillStyle="#aaa";let e=0,t=0;l>.5?(t=1,e=2*(1-l)):(e=1,t=2*l);let n=0;d.context.fillStyle=`rgba(${255*e}, ${255*t}, ${255*n}, 1.0)`}else if(3==f){d.context.fillStyle="#f80";let e=1,t=1-g,n=0;d.context.fillStyle=`rgba(${255*e}, ${255*t}, ${255*n}, 1.0)`}else if(4==f)d.context.fillStyle="#f80";else if(1==f){let e=0,t=0,n=0;l>.5?(n=1,t=1,e=2*(1-l)):(e=1,n=2*l,t=2*l),d.context.fillStyle=`rgba(${255*e}, ${255*t}, ${255*n}, 1.0)`}else d.context.fillStyle=0==f?"#FF0":"#f0f";d.context.beginPath(),d.context.arc((o+.5-e.x-y-v)*e.zoom*u,(_+.5-e.y-b-x)*e.zoom*u,a*u*.5*e.zoom,0,2*Math.PI),d.context.fill()}}m("render_view"),document.getElementById("p_step").innerHTML=`Step: ${i}`}!function(){for(let e in u)if((0,i.Zh)(u[e].values)>0){for(;(0,i.Zh)(u[e].values)>u[e].size;)u[e].values.shift();let t=0;for(let n of u[e].values)t+=n;u[e].value=t/(0,i.Zh)(u[e].values),document.getElementById(`p_counter_${e}`).innerHTML=`${e}: ${u[e].value.toFixed(2)}ms`}}(),document.getElementById("p_fps").innerHTML=`FPS: ${(1e3/u.frame.value).toFixed(0)}`,window.requestAnimationFrame((function(){p()})),m("render")}function _(e,t,n){t.beginPath(),t.fillStyle=n,t.rect(0,0,e.width,e.height),t.fill()}function f(e){return Math.max(e.canvas.width,e.canvas.height)}function l(e,t,n,i,r,a){i.fillStyle=r?"#000":"#888",i.beginPath(),i.arc(e*a.width,t*a.height,n*a.width*.5,0,2*Math.PI),i.fill()}function g(e){u[e].start=performance.now()}function m(e){u[e].values.push(performance.now()-u[e].start)}function h(){document.getElementById("connection_status").innerHTML="Connecting...";let e=document.getElementById("url_selector").selectedOptions[0].value;a&&a.close(),a=new WebSocket(e),a.binaryType="arraybuffer",a.onopen=function(e){document.getElementById("connection_status").innerHTML="Connected",console.log("[open] Connection established"),a.send(JSON.stringify({request:"create_sender",uuid:(0,i.vc)()}))},a.onmessage=function(e){r=e.data},a.onclose=function(e){document.getElementById("connection_status").innerHTML="Closed",e.wasClean?console.error(`[close] Connection closed cleanly, code=${e.code} reason=${e.reason}`):(console.error("[close] Connection died"),console.error("        Retrying in 1 sec."),window.setTimeout((function(){h()}),1e3))},a.onerror=function(e){document.getElementById("connection_status").innerHTML="Error",console.error(e),console.error(`[error] ${e.message}`)},console.log("Waiting for server")}},690:(e,t,n)=>{"use strict";n.a(e,(async e=>{n.d(t,{M:()=>c});var i=n(650),r=(n(411),n(162),n(361)),a=n(437),o=n(209),d=n(291),u=n(980),s=e([r,i]);[r,i]=s.then?await s:s;function c(){let e=!1;const t=window.location.search.replace("?","").split("&");for(var n of t)n.split("=")[0],n.split("=")[1],e=!0;document.getElementById("content").innerHTML='<canvas id="canvas"></canvas>\n<div id="panel">\n<div id="menu">\n  <a href="/playground">Playground</a>\n  <a href="/gallery">Gallery</a>\n  <a href="/gallery?webgpu=true">Gallery (WebGPU)</a>\n</div>\n  <canvas id="minimap"></canvas>\n  <div>\n    Zoom: <input type="range" min="0" max="1000" value="900" id="zoom_slider">\n  </div>\n  <div>\n    x: <input type="range" min="0" max="1000" value="500" id="x_slider">\n  </div>\n  <div>\n    y: <input type="range" min="0" max="1000" value="500" id="y_slider">\n  </div>\n  <p id="p_step"></p>\n  <p id="p_fps"></p>\n  <p id="p_render_duration"></p>\n  <p id="p_counter_map"></p>\n  <p id="p_counter_await_map"></p>\n  <p id="p_counter_put_image"></p>\n  <p id="p_cps"></p>\n  <p id="p_compute_duration"></p>\n  <p id="p_pids"></p>\n  <pre id="p_counter_global"></pre>\n  <pre id="p_counter_activity"></pre>\n  <pre id="p_counter_collision"></pre>\n  <pre id="p_counter_linked"></pre>\n  <p id="p_energy"></p>\n</div>';const r=i.xF.new(128,128),d=i.fU.new(5,.25,5);d.add(0,1,6),d.add(1,0,7);let u=3;u=5,d.add(1,3,5),d.add(3,0,5),d.add(1,4,5),d.add(5,0,5),d.add(1,6,6),d.add(7,0,6),d.add(6,4,5),d.add(5,7,5),r.add_entity_full(d,i.E9.new(.5,.5));for(var s=0;s<100;s++)r.add_entity(d,i.E9.new(Math.random(),Math.random()));if(b(r),"gpu"in navigator)!async function(e){const t=await navigator.gpu.requestAdapter();if(!t)return void console.error("No gpu adapter found");const n={buffer_size:212992},i={data_buffer_size:n.buffer_size,image_width:Math.floor(1*window.innerWidth),image_height:Math.floor(1*window.innerHeight),max_parts_sqrt:64};i.device=await t.requestDevice(),i.buffers={write:i.device.createBuffer({size:n.buffer_size,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),in:i.device.createBuffer({size:n.buffer_size,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}),out:i.device.createBuffer({size:m(i),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}),previous_img:i.device.createBuffer({size:m(i),usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC}),read:i.device.createBuffer({size:m(i),usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),write_data:i.device.createBuffer({size:48,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),in_data:i.device.createBuffer({size:48,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC})},i.bind_group_layouts={reset:i.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),trace:i.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]})},i.bind_groups={reset:i.device.createBindGroup({layout:i.bind_group_layouts.reset,entries:[{binding:0,resource:{buffer:i.buffers.previous_img}},{binding:1,resource:{buffer:i.buffers.out}}]}),trace:i.device.createBindGroup({layout:i.bind_group_layouts.trace,entries:[{binding:0,resource:{buffer:i.buffers.in}},{binding:1,resource:{buffer:i.buffers.out}},{binding:2,resource:{buffer:i.buffers.in_data}}]})},i.workgroup_size=16,i.dispatch=Math.ceil(64/i.workgroup_size),i.compute_pipelines={reset:i.device.createComputePipeline({layout:i.device.createPipelineLayout({bindGroupLayouts:[i.bind_group_layouts.reset]}),compute:{module:i.device.createShaderModule({code:a.U(i)}),entryPoint:"main"}}),trace:i.device.createComputePipeline({layout:i.device.createPipelineLayout({bindGroupLayouts:[i.bind_group_layouts.trace]}),compute:{module:i.device.createShaderModule({code:o.U(i)}),entryPoint:"main"}})};const r=document.getElementById("canvas");r.width=i.image_width,r.height=i.image_height,r.style.width=window.innerWidth+"px",r.style.height=window.innerHeight+"px";g(e,i,r.getContext("2d"))}(r);else{const e="Gravitle works best with WebGPU.\nInstructions on how to enable at https://web.dev/gpu/#use";alert(e),console.error(e),y(r)}}const p={};for(var _ of["put_image","map","await_map"])p[_]={start:performance.now(),values:[],max:100};function f(e){p[e].start=performance.now()}function l(e){p[e].values.push(performance.now()-p[e].start)}async function g(e,t,n){const i=performance.now();void 0===t.fps_counter&&(t.fps_counter=[]),void 0===t.fps_counter_length&&(t.fps_counter_length=100);const a=Math.max(canvas.width,canvas.height),o={x:document.getElementById("x_slider").value/1e3,y:document.getElementById("y_slider").value/1e3,zoom:1e3/(1e3-document.getElementById("zoom_slider").value)},s=(h(o,a).canvas,new Float32Array(new Float32Array(r.memory.buffer,e.parts_ptr(),13*e.parts_count()))),c=(canvas.width,canvas.height,o.x-.5/o.zoom*t.image_width/a),_=o.y-.5/o.zoom*t.image_height/a,w=c+1/o.zoom*t.image_width/a,y=_+1/o.zoom*t.image_height/a;e.parts_count(),f("map");let b=t.buffers.read.mapAsync(GPUMapMode.READ),v=t.buffers.write.mapAsync(GPUMapMode.WRITE),x=t.buffers.write_data.mapAsync(GPUMapMode.WRITE);f("await_map"),await b,await v,await x,l("await_map");const P=e.parts_count();new Float32Array(t.buffers.write_data.getMappedRange()).set([o.zoom,o.x,o.y,P,t.image_width,t.image_height,c,_,w,y,performance.now(),e.get_step()/1]),f("put_image"),n.putImageData(new ImageData(Uint8ClampedArray.from(new Uint32Array(t.buffers.read.getMappedRange())),t.image_width,t.image_height),0,0),l("put_image"),new Float32Array(t.buffers.write.getMappedRange()).set(s),t.buffers.write.unmap(),t.buffers.write_data.unmap(),t.buffers.read.unmap(),l("map");{const e=t.device.createCommandEncoder(),n=e.beginComputePass();n.setPipeline(t.compute_pipelines.reset),n.setBindGroup(0,t.bind_groups.reset),n.dispatch(t.image_width,t.image_height),n.endPass();const i=e.finish();t.device.queue.submit([i])}{const e=t.device.createCommandEncoder();e.copyBufferToBuffer(t.buffers.write,0,t.buffers.in,0,t.data_buffer_size),e.copyBufferToBuffer(t.buffers.write_data,0,t.buffers.in_data,0,48);const n=e.beginComputePass();n.setPipeline(t.compute_pipelines.trace),n.setBindGroup(0,t.bind_groups.trace),n.dispatch(t.dispatch,t.dispatch),n.endPass(),e.copyBufferToBuffer(t.buffers.out,0,t.buffers.read,0,m(t)),e.copyBufferToBuffer(t.buffers.out,0,t.buffers.previous_img,0,m(t));const i=e.finish();t.device.queue.submit([i])}for(let e in p)if((0,u.Zh)(p[e].values)>0){for(;(0,u.Zh)(p[e].values)>p[e].max;)p[e].values.shift();let t=0;for(let n of p[e].values)t+=n;t/=(0,u.Zh)(p[e].values),document.getElementById(`p_counter_${e}`).innerHTML=`${e}: ${t.toFixed(2)}ms`}document.getElementById("p_counter_global").innerHTML=`Compute:     ${e.get_counter_value(0).toFixed(2)}ms`,document.getElementById("p_counter_activity").innerHTML=`  Activity:  ${e.get_counter_value(2).toFixed(2)}ms`,document.getElementById("p_counter_collision").innerHTML=`  Collision: ${e.get_counter_value(1).toFixed(2)}ms`,document.getElementById("p_counter_linked").innerHTML=`    Linked:  ${e.get_counter_value(3).toFixed(2)}ms`,document.getElementById("p_energy").innerHTML=`Energy: ${e.get_total_energy().toFixed(2)}`,(0,d.O)(t),window.requestAnimationFrame((function(){g(e,t,n)}));const U=performance.now();t.fps_counter.push({start:i,end:U,duration:U-i})}function m(e){return e.image_width*e.image_height*4*4}function h(e,t){const n=document.getElementById("minimap");n.width=256,n.height=256;const i=n.getContext("2d");return i.beginPath(),i.fillStyle="#ff000088",i.rect(e.x*n.width-.5*n.width/e.zoom,e.y*n.height-.5*n.height/e.zoom,n.width/e.zoom,n.height/e.zoom),i.fill(),i.beginPath(),i.fillStyle="#FFFF0088",i.rect(e.x*n.width-.5*n.width/e.zoom*canvas.width/t,e.y*n.height-.5*n.height/e.zoom*canvas.height/t,n.width/e.zoom*canvas.width/t,n.height/e.zoom*canvas.height/t),i.fill(),i.fillStyle="#000",i}function w(e,t,n,i,r){i.fillStyle=r?"#888":"#000",i.beginPath(),i.arc(e*minimap.width,t*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc((e+1)*minimap.width,t*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc((e-1)*minimap.width,t*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc(e*minimap.width,(t+1)*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill(),i.beginPath(),i.arc(e*minimap.width,(t-1)*minimap.height,n*minimap.width*.5,0,2*Math.PI),i.fill()}function y(e){const t=document.getElementById("canvas");t.width=window.innerWidth,t.height=window.innerHeight,t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px";const n=t.getContext("2d"),i=Math.max(t.width,t.height),a={x:document.getElementById("x_slider").value/1e3,y:document.getElementById("y_slider").value/1e3,zoom:1e3/(1e3-document.getElementById("zoom_slider").value)},o=h(a,i),d=(o.canvas,new Float32Array(r.memory.buffer,e.parts_ptr(),13*e.parts_count())),u=.5*(1-1/a.zoom),s=u*t.width/i,c=u*t.height/i,p=(i-t.width)/i*.5,_=(i-t.height)/i*.5;for(let t=0;t<e.parts_count();t++){const e=d[13*t+0],r=d[13*t+1],u=d[13*t+4];w(e,r,u,o),n.fillStyle="#aaa",n.beginPath(),n.arc((e+.5-a.x-s-p)*a.zoom*i,(r+.5-a.y-c-_)*a.zoom*i,u*i*.5*a.zoom,0,2*Math.PI),n.fill()}window.requestAnimationFrame((function(){y(e)}))}function b(e){e.tick(),window.setTimeout((async function(){await b(e)}),5)}}))},291:(e,t,n)=>{"use strict";n.d(t,{O:()=>r});var i=n(980);function r(e){if((0,i.Zh)(e.fps_counter)>0){for(;(0,i.Zh)(e.fps_counter)>e.fps_counter_length;)e.fps_counter.shift();let t=0;for(let n of e.fps_counter)t+=n.duration;t/=(0,i.Zh)(e.fps_counter),document.getElementById("p_render_duration").innerHTML=`Render: ${t.toFixed(2)}ms`,document.getElementById("p_fps").innerHTML=`FPS: ${((0,i.Zh)(e.fps_counter)/((0,i.Z$)(e.fps_counter).end-e.fps_counter[0].start)*1e3).toFixed(1)} `}}},437:(e,t,n)=>{"use strict";function i(e){return`// Render shader\n// struct Part {\n//   x: f32;\n//   y: f32;\n//   x_old: f32;\n//   y_old: f32;\n//   m: f32;\n//   d: f32;\n//   d: f32;\n// };\n// [[block]] struct Data {\n//   zoom: f32;\n//   center_x: f32;\n//   center_y: f32;\n// };\n// [[block]] struct Parts {\n//   parts: array<Part>;\n// };\nstruct Pixel {\n  r: i32;\n  g: i32;\n  b: i32;\n  a: i32;\n};\n[[block]] struct Image {\n  pix: array<Pixel, ${e.image_width*e.image_height}>;\n};\n[[group(0), binding(0)]] var<storage, read>   input     : Image;\n[[group(0), binding(1)]] var<storage, write>  output    : Image;\n[[stage(compute), workgroup_size(2, 2)]]\nfn main([[builtin(global_invocation_id)]] gid : vec3<u32>) {\n  let pix_id = gid.x + gid.y * ${e.image_width}u;\n  // output.pix[pix_id].r = max(input.pix[pix_id].r - 1u, 0u);\n  // output.pix[pix_id].g = max(input.pix[pix_id].g - 1u, 0u);\n  // output.pix[pix_id].b = max(input.pix[pix_id].b - 1u, 0u);\n\n  let fade = 100;\n\n  output.pix[pix_id].r = min(max(input.pix[pix_id].r - fade, 0), 255);\n  output.pix[pix_id].g = min(max(input.pix[pix_id].g - fade, 0), 255);\n  output.pix[pix_id].b = min(max(input.pix[pix_id].b - fade, 0), 255);\n\n  output.pix[pix_id].a = 255;\n}\n`}n.d(t,{U:()=>i})},209:(e,t,n)=>{"use strict";function i(e){return`// Render shader\nstruct Part {\n  x: f32;\n  y: f32;\n  x_old: f32;\n  y_old: f32;\n  d: f32;\n  m: f32;\n  kind: u32;\n  ta: f32;\n  tb: f32;\n  tc: f32;\n  td: f32;\n  direction_x: f32;\n  direction_y:  f32;\n};\nstruct Kind {\n  FIREFLY: u32;\n  METAL: u32;\n  TURBO: u32;\n  DIATOM: u32;\n  NEURON: u32;\n  MOUTH:  u32;\n  CORE:  u32;\n  EGG:  u32;\n};\nlet kind: Kind = Kind(1u, 2u, 3u, 4u, 5u, 6u, 7u, 8u);\n[[block]] struct Data {\n  zoom: f32;\n  center_x: f32;\n  center_y: f32;\n  count: f32;\n  image_width: f32;\n  image_height: f32;\n  x_min: f32;\n  y_min: f32;\n  x_max: f32;\n  y_max: f32;\n  time: f32;\n  step: f32;\n};\n[[block]] struct Parts {\n  parts: array<Part>;\n};\nstruct Pixel {\n  r: u32;\n  g: u32;\n  b: u32;\n  a: u32;\n};\n[[block]] struct Image {\n  pix: array<Pixel, ${e.image_width*e.image_height}>;\n};\n[[group(0), binding(0)]] var<storage, read>   input     : Parts;\n[[group(0), binding(1)]] var<storage, write>  output    : Image;\n[[group(0), binding(2)]] var<storage, read>   data      : Data;\n[[stage(compute), workgroup_size(${e.workgroup_size}, ${e.workgroup_size})]]\nfn main([[builtin(global_invocation_id)]] gid : vec3<u32>) {\n  let part_id = gid.x + gid.y * ${e.max_parts_sqrt}u;\n  let zoom = min(10.0, data.zoom);\n  if (part_id <= u32(data.count))\n  {\n    let part = input.parts[part_id];\n    var part_x = part.x;\n    var part_y = part.y;\n    if (part_x > data.x_max) {\n      part_x = part_x - 1.0;\n    }\n    if (part_y > data.y_max) {\n      part_y = part_y - 1.0;\n    }\n\n    if (\n      data.x_min <= part_x && part_x <= data.x_max\n      && data.y_min <= part_y && part_y <= data.y_max\n    )\n    {\n      let x = part_x * zoom;\n      let y = part_y * zoom;\n      let cd_max = max(data.image_height, data.image_width);\n      let d = max(min(0.1, part.d), 0.0001);\n      let rayon  = d * 0.5 * zoom;\n      let cd_min = min(data.image_height, data.image_width);\n      let resolution = 0.00005 * zoom;\n      let boo = cd_max * 0.5 * (zoom - 1.0) ;\n      let bup_x = (0.5 - data.center_x) * zoom * cd_max - (cd_max - data.image_width) * 0.5 - boo;\n      let bup_y = (0.5 - data.center_y) * zoom * cd_max - (cd_max - data.image_height)* 0.5 - boo;\n\n      let i_min = -rayon;\n      let i_max = rayon;\n      let j_min = -rayon;\n      let j_max = rayon;\n\n      for (var i = i_min ; i < i_max ; i=i+resolution ) {\n        for (var j = j_min ; j < j_max ; j=j+resolution ) {\n          let xx = (x+i) * cd_max + bup_x ;\n          let yy = (y+j) * cd_max + bup_y ;\n          if (xx < data.image_width) {\n            let pix_id = u32(xx) + u32(yy) * u32(data.image_width);\n            // distance from center\n            let dc = sqrt(i*i+j*j) / (d * zoom * 0.5);\n            let angle_ = fract(1.75 - (0.5 - 0.5*j/abs(j) * acos(normalize(vec2<f32>(i, j)).x) * 0.3183098861837907));\n            let angle = fract(angle_ + data.time * 0.00025);\n            if ( dc < 1.0) {\n              var r = 0.0;\n              var g = 0.0;\n              var b = 0.0;\n              if (part.kind == kind.FIREFLY) {\n                // output.pix[pix_id].r = 150u + u32(255.0 * dc );\n                // output.pix[pix_id].g = u32(255.0 * sin(angle*100.0)*dc);\n                // output.pix[pix_id].b = 0u;\n                // output.pix[pix_id].a = 255u;\n              } elseif (part.kind == kind.METAL) {\n                // output.pix[pix_id].r = 100u;\n                // output.pix[pix_id].g = 100u;\n                // output.pix[pix_id].b = 200u;\n                // output.pix[pix_id].a = 255u;\n              } elseif (part.kind == kind.MOUTH) {\n                r = 1.0;\n                g = 1.0;\n              } elseif (part.kind == kind.DIATOM) {\n                // output.pix[pix_id].r = 0u;\n                // output.pix[pix_id].g = 255u;\n                // output.pix[pix_id].b = 200u;\n                // output.pix[pix_id].a = 255u;\n              } elseif (part.kind == kind.TURBO) {\n                // r = 0.75 + part.ta ;\n                // g = 0.75;\n                r = 0.75;\n                g = part.ta *   (1.0-sin(dc*0.7));\n              } elseif (part.kind == kind.NEURON) {\n                r = 0.25;\n                g = part.ta *   (1.0-sin(dc*0.7));\n                b = part.ta *   (1.0-sin(dc*0.7));\n              } elseif (part.kind == kind.CORE) {\n                if (part.ta < 1.0) {\n                  r = 1.0 - part.ta;\n                  g = part.ta;\n                } else {\n                  b = part.ta - 1.0;\n                  g = 1.0;\n                }\n              } else {\n                r = 1.0;\n                b = 1.0;\n              }\n              output.pix[pix_id].r = u32(255.0 * r);\n              output.pix[pix_id].g = u32(255.0 * g);\n              output.pix[pix_id].b = u32(255.0 * b);\n              output.pix[pix_id].a = 255u;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n`}n.d(t,{U:()=>i})},980:(e,t,n)=>{"use strict";n.d(t,{hu:()=>r,Z$:()=>o,Zh:()=>a,vc:()=>d});var i=n(586);function r(e){e||console.error("failed condition")}function a(e){return e.length}function o(e){return a(e)>0?e[a(e)-1]:void 0}function d(){return i.Z()}},162:(e,t,n)=>{"use strict";n(32)},411:(e,t,n)=>{"use strict";var i=n(980),r=n(32);Object.keys(r.N).length;let a=0;const o=a++;a++,a++,a++,a++,a++,a++,a++,a++,a++,a++,(0,i.hu)(0===o&&!0)},650:(e,t,n)=>{"use strict";n.a(e,(async i=>{n.d(t,{fU:()=>x,E9:()=>P,xF:()=>U,ug:()=>B,DW:()=>z,Ih:()=>E,yq:()=>M,gk:()=>C,Um:()=>T,vN:()=>I,mS:()=>G,C2:()=>S,cx:()=>O,rY:()=>F,Wl:()=>A,UE:()=>k,Im:()=>R,eY:()=>L,dS:()=>$,Oi:()=>H,gl:()=>D,wg:()=>W,BT:()=>Y,JX:()=>j,xd:()=>q,ud:()=>Z,PT:()=>N,XP:()=>J,jp:()=>K,y4:()=>X,YQ:()=>V,A7:()=>Q,b0:()=>ee,uf:()=>te,m_:()=>ne,Or:()=>ie,oH:()=>re});var r=n(361);e=n.hmd(e);var a=i([r]);r=(a.then?await a:a)[0];const o=new Array(32).fill(void 0);function d(e){return o[e]}o.push(void 0,null,!0,!1);let u=o.length;function s(e){u===o.length&&o.push(o.length+1);const t=u;return u=o[t],o[t]=e,t}let c=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});c.decode();let p=null;function _(){return null!==p&&p.buffer===r.memory.buffer||(p=new Uint8Array(r.memory.buffer)),p}function f(e,t){return c.decode(_().subarray(e,e+t))}function l(e,t){if(!(e instanceof t))throw new Error(`expected instance of ${t.name}`);return e.ptr}let g=0,m=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const h="function"==typeof m.encodeInto?function(e,t){return m.encodeInto(e,t)}:function(e,t){const n=m.encode(e);return t.set(n),{read:e.length,written:n.length}};let w=null;function y(){return null!==w&&w.buffer===r.memory.buffer||(w=new Int32Array(r.memory.buffer)),w}function b(e,t){try{return e.apply(this,t)}catch(e){r.__wbindgen_exn_store(s(e))}}function v(e,t){return _().subarray(e/1,e/1+t)}Object.freeze({Firefly:1,1:"Firefly",Metal:2,2:"Metal",Turbo:3,3:"Turbo",Diatom:4,4:"Diatom",Neuron:5,5:"Neuron",Mouth:6,6:"Mouth",Core:7,7:"Core",Egg:8,8:"Egg"}),Object.freeze({Activity:1,1:"Activity",Energy:3,3:"Energy",Bias:4,4:"Bias"});class x{static __wrap(e){const t=Object.create(x.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_plan_free(e)}get k1(){return r.__wbg_get_plan_k1(this.ptr)>>>0}set k1(e){r.__wbg_set_plan_k1(this.ptr,e)}get f(){return r.__wbg_get_plan_f(this.ptr)}set f(e){r.__wbg_set_plan_f(this.ptr,e)}get k2(){return r.__wbg_get_plan_k2(this.ptr)>>>0}set k2(e){r.__wbg_set_plan_k2(this.ptr,e)}static new(e,t,n){var i=r.plan_new(e,t,n);return x.__wrap(i)}add(e,t,n){r.plan_add(this.ptr,e,t,n)}}class P{static __wrap(e){const t=Object.create(P.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_point_free(e)}get x(){return r.__wbg_get_point_x(this.ptr)}set x(e){r.__wbg_set_point_x(this.ptr,e)}get y(){return r.__wbg_get_point_y(this.ptr)}set y(e){r.__wbg_set_point_y(this.ptr,e)}static new(e,t){var n=r.point_new(e,t);return P.__wrap(n)}}class U{static __wrap(e){const t=Object.create(U.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();r.__wbg_server_free(e)}static new(e,t){var n=r.server_new(e,t);return U.__wrap(n)}add_part(e,t,n){l(t,P),l(n,P),r.server_add_part(this.ptr,e,t.ptr,n.ptr)}add_entity(e,t){l(e,x),l(t,P),r.server_add_entity(this.ptr,e.ptr,t.ptr)}add_entity_full(e,t){l(e,x),l(t,P),r.server_add_entity_full(this.ptr,e.ptr,t.ptr)}add_entity_(e,t,n){l(e,x),l(t,P),r.server_add_entity_(this.ptr,e.ptr,t.ptr,n)}tick(){r.server_tick(this.ptr)}parts_count(){return r.server_parts_count(this.ptr)>>>0}parts_ptr(){return r.server_parts_ptr(this.ptr)}get_step(){return r.server_get_step(this.ptr)>>>0}get_total_energy(){return r.server_get_total_energy(this.ptr)}get_counter_value(e){return r.server_get_counter_value(this.ptr,e)}}function B(e){!function(e){const t=d(e);(function(e){e<36||(o[e]=u,u=e)})(e)}(e)}function z(e,t){console.log(f(e,t))}function E(){return s(new Error)}function M(e,t){var n=function(e,t,n){if(void 0===n){const n=m.encode(e),i=t(n.length);return _().subarray(i,i+n.length).set(n),g=n.length,i}let i=e.length,r=t(i);const a=_();let o=0;for(;o<i;o++){const t=e.charCodeAt(o);if(t>127)break;a[r+o]=t}if(o!==i){0!==o&&(e=e.slice(o)),r=n(r,i,i=o+3*e.length);const t=_().subarray(r+o,r+i);o+=h(e,t).written}return g=o,r}(d(t).stack,r.__wbindgen_malloc,r.__wbindgen_realloc),i=g;y()[e/4+1]=i,y()[e/4+0]=n}function C(e,t){try{console.error(f(e,t))}finally{r.__wbindgen_free(e,t)}}function T(e){return d(e)instanceof Window}function I(e){var t=d(e).performance;return null==t?0:s(t)}function G(e){return d(e).now()}function S(){return b((function(e,t){d(e).getRandomValues(d(t))}),arguments)}function O(){return b((function(e,t,n){d(e).randomFillSync(v(t,n))}),arguments)}function F(e){return s(d(e).process)}function A(e){const t=d(e);return"object"==typeof t&&null!==t}function k(e){return s(d(e).versions)}function R(e){return s(d(e).node)}function L(e){return"string"==typeof d(e)}function $(){return b((function(e,t){return s(n(964)(f(e,t)))}),arguments)}function H(e){return s(d(e).crypto)}function D(e){return s(d(e).msCrypto)}function W(e,t){return s(new Function(f(e,t)))}function Y(){return b((function(e,t){return s(d(e).call(d(t)))}),arguments)}function j(){return b((function(){return s(self.self)}),arguments)}function q(){return b((function(){return s(window.window)}),arguments)}function Z(){return b((function(){return s(globalThis.globalThis)}),arguments)}function N(){return b((function(){return s(n.g.global)}),arguments)}function J(e){return void 0===d(e)}function K(e){return s(d(e).buffer)}function X(e){return s(new Uint8Array(d(e)))}function V(e,t,n){d(e).set(d(t),n>>>0)}function Q(e){return d(e).length}function ee(e){return s(new Uint8Array(e>>>0))}function te(e,t,n){return s(d(e).subarray(t>>>0,n>>>0))}function ne(e){return s(d(e))}function ie(e,t){throw new Error(f(e,t))}function re(){return s(r.memory)}}))},964:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=964,e.exports=t},361:(e,t,n)=>{"use strict";var i=([i])=>n.v(t,e.id,"5565d2ecda665c9da4d1",{"./wasm_bg.js":{__wbindgen_object_drop_ref:i.ug,__wbg_log_682923c8ea4d4d53:i.DW,__wbg_new_693216e109162396:i.Ih,__wbg_stack_0ddaca5d1abfb52f:i.yq,__wbg_error_09919627ac0992f5:i.gk,__wbg_instanceof_Window_c4b70662a0d2c5ec:i.Um,__wbg_performance_947628766699c5bb:i.vN,__wbg_now_559193109055ebad:i.mS,__wbg_getRandomValues_98117e9a7e993920:i.C2,__wbg_randomFillSync_64cc7d048f228ca8:i.cx,__wbg_process_2f24d6544ea7b200:i.rY,__wbindgen_is_object:i.Wl,__wbg_versions_6164651e75405d4a:i.UE,__wbg_node_4b517d861cbcb3bc:i.Im,__wbindgen_is_string:i.eY,__wbg_modulerequire_3440a4bcf44437db:i.dS,__wbg_crypto_98fc271021c7d2ad:i.Oi,__wbg_msCrypto_a2cdb043d2bfe57f:i.gl,__wbg_newnoargs_be86524d73f67598:i.wg,__wbg_call_888d259a5fefc347:i.BT,__wbg_self_c6fbdfc2918d5e58:i.JX,__wbg_window_baec038b5ab35c54:i.xd,__wbg_globalThis_3f735a5746d41fbd:i.ud,__wbg_global_1bc0b39582740e95:i.PT,__wbindgen_is_undefined:i.XP,__wbg_buffer_397eaa4d72ee94dd:i.jp,__wbg_new_a7ce447f15ff496f:i.y4,__wbg_set_969ad0a60e51d320:i.YQ,__wbg_length_1eb8fc608a0d4cdb:i.A7,__wbg_newwithlength_929232475839a482:i.b0,__wbg_subarray_8b658422a224f479:i.uf,__wbindgen_object_clone_ref:i.m_,__wbindgen_throw:i.Or,__wbindgen_memory:i.oH}});n.a(e,(e=>{var t=e([n(650)]);return t.then?t.then(i):i(t)}),1)}}]);